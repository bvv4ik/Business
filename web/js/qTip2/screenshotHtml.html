<!DOCTYPE html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <style type="text/css">
       
	   #scrollbox {
    width: 300px;
    height: 200px;
    float: right;
    overflow-y: scroll;
}
#boxcontent {
    height: 600px;
    background: purple;
}
	   
    </style>

    <script type="text/javascript" src="http://night-creature.com/html2canvas.js"></script>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	
   
		
</head>



<body onUnLoad="javascript:window.alert('Спасибо, что нас посетили!')>

<div class="gg" id="div1"></div>

<a href="http://www.experts-exchange.com/xp/images/newNavLogo.png" target="_new">

<img src="http://www.experts-exchange.com/xp/images/newNavLogo.png" align="left" alt="" /> </a>

<!-- <div style="height: 4567px">Прокрутите страницу вниз до конца</div> -->

<div id="scrollbox">
    <div id="boxcontent">
    </div>
</div>



<br>
<br>
<br>
<br>

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<span id="scrollpos"></span>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>


    <script>
$(document).ready(function(){	




$(window).unload(function(){ 
  alert("Пока, пользователь!"); 
 // alert(window.screen()); 
});

/*
$("#scrollbox").click(function(){  
alert($('body').scrollTop());   
   });
*/


/* window.onscroll = function (oEvent) {
   //alert($(this).scrollTop());  
   var i = $(this).scrollTop();
   var h = $('#boxcontent').height();
   var r =  (i / h * 100);
   $('#scrollpos').html( i +"    "+ h+"    "+ r);
   
   
}
 */



// узнаем процент прокрутки окна
$('#scrollbox').scroll(function(){
    
    var top = $(this).scrollTop(),
        max = $('#boxcontent').height() - $(this).height();
    
	var res = (top / max * 100);
	$('#scrollpos').html( res/*.toFixed(0) + '%' */);
	   // $('#scrollpos').html( Math.round((top / max * 100)));
    if ( Math.round(res) > 90 )
	alert("d");
	
}).scroll();
 
 
/* 
// узнаем низ скрола окна 
window.onscroll = function ()
{
var B = document.body, 
    DE = document.documentElement,
    O = Math.min (B.clientHeight, DE.clientHeight); if (!O) O = B.clientHeight;
var S = Math.max (B.scrollTop, DE.scrollTop),
    C = Math.max (B.scrollHeight, DE.scrollHeight);
if (O + S == C) //alert ('Мы достигли дна... и снизу постучали!');
document.write(O);

}
*/



/*
var tempScrollTop, currentScrollTop = 0;
$("#div1").scroll(function(){
currentScrollTop = $("#div1").scrollTop();
if (tempScrollTop < currentScrollTop )
 alert("scrolling down");
else if (tempScrollTop > currentScrollTop )
alert("scrolling up");

tempScrollTop = currentScrollTop;

}

*/




});		
//$(document).scroll(function(){
//  alert('Элемент foo был прокручен... скроллирован... ну как там это называется то?!');
//});	
	
	//str1.fontSize(33);
	//alert("dfsdf");	
	//   var email = prompt ("Введите свой e-mail:","username@host.com")

/*	

var arr = [1,2,3,4,5,6,7];
arr.pop(); // ??????? ?????????
arr.push(3, 4); // ????????? 3, 4 ? ?????
arr.unshift(5, 5); // ????????? 3, 4 ? ? ??????
arr.shift(); // ??????? ??????
arr.unshift("dfdsf"); // ????????? ? ??????

var s = arr.slice(1,3); //  ???????? ? 1 ?? 3 ????????

arr.splice(0,2); //  ??????? ? 0 ?? 2 ????????
arr.reverse();

alert(arr.join(", "));
alert(s.join(", "));
//alert(arr.join(", "));
*/



//var arr = [[2, 5, 7], [3, 1, 4], [6, 8, 9]];
/*var arr = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];
var int1 =0;
//arr [1][2] = 999; 
for (var i2 = 0; i2 < 3; i2++) {

for (var i = 0; i < 3; i++) {
	 int1++;  
     arr[i2][i] = int1*int1 ;
	
    //arr[i2][i] = int1 ;
	}
   
}
alert(arr.join(" - "));
*/


//arr[0][0] = "1, 2";

/*for (var i = 0; i < 5; i++) {
   arr[i] = parseInt(prompt("Input"));
}
alert(arr.join(", "));
 */
 //alert(arr.join(" - "));

	
        function downimg(){
            html2canvas($('#downimg'), {
                onrendered: function (canvas) {
                    var img = canvas.toDataURL('image/png').replace("image/png", "image/octet-stream");

					//document.getElementById('img1').src = img;
					SaveToDisk("http://limg.imgsmail.ru/s/images/logo/logo_wide.v2.png", 'image.png');
					
                   //  window.location.href = img;                     
					// window.document.execCommand('SaveAs') ;
				//	document.getElementById('img1').src = img;//$canvas.toDataURL();

					
                }
            });
        }
    </script>

    <a href="javascript:void(0)" onClick="downimg()" >SAVE</a>
</body>
</html>